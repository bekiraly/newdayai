[build]
builder = "NIXPACKS"

[build.nixpacks]
plan = "python"

[build.nixpacks.phases.setup]
cmds = [
  "apt-get update",
  "apt-get install -y wget gnupg ca-certificates",
  "wget https://github.com/microsoft/playwright/releases/download/v1.44.1/playwright-linux-x64.zip -O /tmp/pw.zip",
  "unzip /tmp/pw.zip -d /tmp/pw"
]

[build.nixpacks.phases.install]
cmds = [
  "pip install -r requirements.txt",
  "python -m playwright install chromium"
]

[start]
cmd = "uvicorn api.main:app --host 0.0.0.0 --port $PORT"
